{"ast":null,"code":"import axios from \"axios\";\nconst backendURL = process.env.REACT_APP_BACKEND_URL || \"http://localhost:8000\";\n\n// Create axios instance with timeout\nconst api = axios.create({\n  baseURL: backendURL,\n  timeout: 30000,\n  // 30 seconds timeout\n  headers: {\n    'Content-Type': 'application/json'\n  }\n});\n\n// Add request interceptor for rate limiting info\napi.interceptors.request.use(config => {\n  // You can add auth tokens here if needed\n  return config;\n}, error => {\n  return Promise.reject(error);\n});\n\n// Add response interceptor for error handling\napi.interceptors.response.use(response => response, error => {\n  if (error.code === 'ECONNABORTED') {\n    return Promise.reject(new Error(\"Request timeout. Please try again.\"));\n  }\n  return Promise.reject(error);\n});\nexport const askQuestion = async (question, sessionId = \"default\") => {\n  try {\n    const response = await api.post(\"/ask\", {\n      question,\n      session_id: sessionId // Match backend parameter name\n    });\n    return response.data;\n  } catch (error) {\n    console.error(\"Backend error:\", error.response || error);\n    if (error.response) {\n      // Handle specific HTTP errors\n      const status = error.response.status;\n      const data = error.response.data;\n      if (status === 429) {\n        throw new Error(\"Rate limit exceeded. Please wait a minute before sending more requests.\");\n      } else if (status === 422) {\n        throw new Error(\"Invalid request format. Please try again.\");\n      } else if (status === 500) {\n        throw new Error(\"Server error. Please try again later.\");\n      } else if (status === 404) {\n        throw new Error(\"API endpoint not found. Please check the backend URL.\");\n      } else {\n        throw new Error((data === null || data === void 0 ? void 0 : data.detail) || \"An error occurred. Please try again.\");\n      }\n    } else if (error.message && error.message.includes(\"timeout\")) {\n      throw new Error(\"Request timeout. The server is taking too long to respond.\");\n    } else {\n      // Network error\n      throw new Error(\"Network error. Please check your internet connection and ensure the backend server is running.\");\n    }\n  }\n};\nexport const createSession = async () => {\n  try {\n    const response = await api.post(\"/sessions/new\");\n    return response.data;\n  } catch (error) {\n    console.error(\"Failed to create session:\", error);\n    throw new Error(error.message || \"Failed to create session.\");\n  }\n};\nexport const listSessions = async () => {\n  try {\n    const response = await api.get(\"/sessions\");\n    return response.data;\n  } catch (error) {\n    console.error(\"Failed to list sessions:\", error);\n    throw new Error(error.message || \"Failed to list sessions.\");\n  }\n};\nexport const clearSession = async sessionId => {\n  try {\n    const response = await api.post(`/sessions/${sessionId}/clear`);\n    return response.data;\n  } catch (error) {\n    console.error(\"Failed to clear session:\", error);\n    throw new Error(error.message || \"Failed to clear session.\");\n  }\n};\nexport const healthCheck = async () => {\n  try {\n    const response = await api.get(\"/health\");\n    return response.data;\n  } catch (error) {\n    console.error(\"Health check failed:\", error);\n    return {\n      status: \"offline\",\n      error: error.message\n    };\n  }\n};\n\n// Export the axios instance for other potential uses\nexport default api;","map":{"version":3,"names":["axios","backendURL","process","env","REACT_APP_BACKEND_URL","api","create","baseURL","timeout","headers","interceptors","request","use","config","error","Promise","reject","response","code","Error","askQuestion","question","sessionId","post","session_id","data","console","status","detail","message","includes","createSession","listSessions","get","clearSession","healthCheck"],"sources":["C:/islamic-agent/frontend/src/api.js"],"sourcesContent":["import axios from \"axios\";\r\n\r\nconst backendURL = process.env.REACT_APP_BACKEND_URL || \"http://localhost:8000\";\r\n\r\n// Create axios instance with timeout\r\nconst api = axios.create({\r\n  baseURL: backendURL,\r\n  timeout: 30000, // 30 seconds timeout\r\n  headers: {\r\n    'Content-Type': 'application/json',\r\n  },\r\n});\r\n\r\n// Add request interceptor for rate limiting info\r\napi.interceptors.request.use(\r\n  (config) => {\r\n    // You can add auth tokens here if needed\r\n    return config;\r\n  },\r\n  (error) => {\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\n// Add response interceptor for error handling\r\napi.interceptors.response.use(\r\n  (response) => response,\r\n  (error) => {\r\n    if (error.code === 'ECONNABORTED') {\r\n      return Promise.reject(new Error(\"Request timeout. Please try again.\"));\r\n    }\r\n    return Promise.reject(error);\r\n  }\r\n);\r\n\r\nexport const askQuestion = async (question, sessionId = \"default\") => {\r\n  try {\r\n    const response = await api.post(\"/ask\", { \r\n      question, \r\n      session_id: sessionId  // Match backend parameter name\r\n    });\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Backend error:\", error.response || error);\r\n    \r\n    if (error.response) {\r\n      // Handle specific HTTP errors\r\n      const status = error.response.status;\r\n      const data = error.response.data;\r\n      \r\n      if (status === 429) {\r\n        throw new Error(\"Rate limit exceeded. Please wait a minute before sending more requests.\");\r\n      } else if (status === 422) {\r\n        throw new Error(\"Invalid request format. Please try again.\");\r\n      } else if (status === 500) {\r\n        throw new Error(\"Server error. Please try again later.\");\r\n      } else if (status === 404) {\r\n        throw new Error(\"API endpoint not found. Please check the backend URL.\");\r\n      } else {\r\n        throw new Error(data?.detail || \"An error occurred. Please try again.\");\r\n      }\r\n    } else if (error.message && error.message.includes(\"timeout\")) {\r\n      throw new Error(\"Request timeout. The server is taking too long to respond.\");\r\n    } else {\r\n      // Network error\r\n      throw new Error(\"Network error. Please check your internet connection and ensure the backend server is running.\");\r\n    }\r\n  }\r\n};\r\n\r\nexport const createSession = async () => {\r\n  try {\r\n    const response = await api.post(\"/sessions/new\");\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Failed to create session:\", error);\r\n    throw new Error(error.message || \"Failed to create session.\");\r\n  }\r\n};\r\n\r\nexport const listSessions = async () => {\r\n  try {\r\n    const response = await api.get(\"/sessions\");\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Failed to list sessions:\", error);\r\n    throw new Error(error.message || \"Failed to list sessions.\");\r\n  }\r\n};\r\n\r\nexport const clearSession = async (sessionId) => {\r\n  try {\r\n    const response = await api.post(`/sessions/${sessionId}/clear`);\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Failed to clear session:\", error);\r\n    throw new Error(error.message || \"Failed to clear session.\");\r\n  }\r\n};\r\n\r\nexport const healthCheck = async () => {\r\n  try {\r\n    const response = await api.get(\"/health\");\r\n    return response.data;\r\n  } catch (error) {\r\n    console.error(\"Health check failed:\", error);\r\n    return { status: \"offline\", error: error.message };\r\n  }\r\n};\r\n\r\n// Export the axios instance for other potential uses\r\nexport default api;"],"mappings":"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","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}